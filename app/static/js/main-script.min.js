"use strict";document.addEventListener("readystatechange",async()=>{if("complete"!=document.readyState){return}const t=document.querySelector("#inputs"),n=document.querySelector("#input-text");var e=document.querySelector("#input-submit"),a=document.querySelector("#input-reset"),s=document.querySelector("#input-stop");const i=document.querySelector("#messages-list"),r=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");let o;const l={isGenerating:!1,animDotsIntSpeed:200,animDotsInterval:-1,animDotsLength:0,updateGenIntSpeed:2e3,updateGenInterval:-1},c=(l.animDotsLength=Math.floor(l.updateGenIntSpeed/l.animDotsIntSpeed),l.updateGenIntSpeed=l.updateGenIntSpeed+l.animDotsIntSpeed,async(e,t=null)=>{try{var n={method:"POST",headers:{"Content-Type":"application/json"},body:null==t?"":JSON.stringify(t)};return await(await fetch(e,n)).json()}catch(e){return e}}),d=(e,t="",n="")=>{var a=document.createElement("p");return a.innerHTML=`<strong>${e}</strong>`,t&&(a.innerHTML+=t),n&&(a.innerHTML+=`<span>${n}</span>`),a.setAttribute("class","message"),i.appendChild(a),a},u=()=>{const e="Generating";null==(o=i.querySelector("#generating-msg"))&&(o=d(e)).setAttribute("id","generating-msg");let t="";window.clearInterval(l.animDotsInterval),l.animDotsInterval=window.setInterval(()=>{t.length<l.animDotsLength?t+=".":t="",o&&(o.innerHTML=`<strong>${e}</strong>`+t)},l.animDotsIntSpeed)},p=async(e=!1)=>{var t=await c(r+"/llm-list-msgs");if(console.log(t["message"]),e&&(l.isGenerating=t["is-generating"]),t["messages-list"]){i.innerHTML="";for(const n of t["messages-list"]){d(n.name,n.content.replaceAll("\n","<br/>"),n.date)}}},m=(e=!1)=>{e?t.scrollIntoView({behavior:"smooth",block:"end"}):t.scrollIntoView({block:"end"}),n.focus()},g=e=>"mouseup"==e.type&&0==e.button,w=async()=>{var e;l.isGenerating||(e=n.value.trim(),n.value="",e&&(l.isGenerating=!0,await p(),await v(),m(),await c(r+"/",{"prompt":e})))},y=async()=>{window.clearInterval(l.updateGenInterval),window.clearInterval(l.animDotsInterval),o&&o.remove()},v=async()=>{await p(),u(),window.clearInterval(l.updateGenInterval),l.updateGenInterval=setInterval(async()=>{await p(!0),l.isGenerating?u():(y(),m(!0))},l.updateGenIntSpeed)};n.value="",n.addEventListener("keyup",async e=>{"keyup"==(e=e).type&&e.ctrlKey&&13==e.keyCode&&await w()},!1),e.addEventListener("mouseup",async e=>{g(e)&&await w()},!1),a.addEventListener("mouseup",async e=>{g(e)&&(await c(r+"/llm-reset-msgs"),l.isGenerating=!1,y(),await p())},!1),s.addEventListener("mouseup",async e=>{g(e)&&await(!l.isGenerating||(await c(r+"/llm-stop-gen"),l.isGenerating=!1,y(),!await p()))},!1),await p(!0),l.isGenerating&&(await v(),m())});